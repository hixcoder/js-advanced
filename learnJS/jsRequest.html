<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h2>hello js Request</h2>
    <div id="content"></div>
    <script>
      // GET request
      function readPosts() {
        let request = new XMLHttpRequest();
        request.open("GET", "https://jsonplaceholder.typicode.com/posts/");
        request.responseType = "json";
        request.send();
        request.onload = function () {
          if (request.status >= 200 && request.status < 300) {
            let posts = request.response;
            for (post of posts) {
              document.getElementById(
                "content"
              ).innerHTML += `<h1>${post.title}</h1>`;
              console.log(post.title);
            }
          } else {
            alert("Error");
            console.log(response);
          }
        };
      }

      // POST request
      function createNewPost() {
        let request = new XMLHttpRequest();
        request.open("POST", "https://jsonplaceholder.typicode.com/posts");
        request.responseType = "json";
        request.setRequestHeader("Accept", "application/json");
        // request.setRequestHeader("Content-type", "application/json");
        let bodyParams = `{
          "title":
            "sunt aut facere repellat provident occaecati excepturi optio reprehenderit",
            "body": "quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto",
            "userId": 2
        }`;
        request.send(bodyParams);
        request.onload = function () {
          if (request.status >= 200 && request.status < 300) {
            let response = request.response;
            console.log(response);
            console.log("status code: " + request.status);
            alert("the post has been created successfully");
          } else {
            alert("Error");
            console.log(response);
          }
        };
      }

      // PUT request
      function replacePost() {
        let request = new XMLHttpRequest();
        request.open("PUT", "https://jsonplaceholder.typicode.com/posts/5");
        request.responseType = "json";
        request.setRequestHeader("Accept", "application/json");
        request.setRequestHeader("Content-type", "application/json");
        let bodyParams = `{
            "title": "hix",
            "body": "hello world",
            "userId": 2,
            "id": 5
        }`;
        request.send(bodyParams);
        request.onload = function () {
          if (request.status >= 200 && request.status < 300) {
            let response = request.response;
            console.log(response);
            console.log("status code: " + request.status);
            alert("the post has been replaced successfully");
          } else {
            alert("Error");
            console.log(response);
          }
        };
      }

      // PATCH request
      function updatePost() {
        let request = new XMLHttpRequest();
        request.open("PATCH", "https://jsonplaceholder.typicode.com/posts/5");
        request.responseType = "json";
        request.setRequestHeader("Accept", "application/json");
        // request.setRequestHeader("Content-type", "application/json");
        let bodyParams = `{
            "title": "hix",
            "id": 5
        }`;
        request.send(bodyParams);
        request.onload = function () {
          if (request.status >= 200 && request.status < 300) {
            let response = request.response;
            console.log(response);
            console.log("status code: " + request.status);
            alert("the post has been updated successfully");
          } else {
            alert("Error");
            console.log(response);
          }
        };
      }

      // DELETE request
      function deletePost() {
        let request = new XMLHttpRequest();
        request.open("DELETE", "https://jsonplaceholder.typicode.com/posts/5");
        request.responseType = "json";
        request.setRequestHeader("Accept", "application/json");
        request.setRequestHeader("Content-type", "application/json");
        request.send();
        request.onload = function () {
          if (request.status >= 200 && request.status < 300) {
            let response = request.response;
            console.log(response);
            console.log("status code: " + request.status);
            alert("the post has been deleted successfully");
          } else {
            alert("Error");
            console.log(response);
          }
        };
      }
      // GET request with filter
      function readPostsWithIdFilter() {
        let request = new XMLHttpRequest();
        request.open(
          "GET",
          "https://jsonplaceholder.typicode.com/posts?userId=5"
        );
        request.responseType = "json";
        request.send();
        request.onload = function () {
          if (request.status >= 200 && request.status < 300) {
            let posts = request.response;
            for (post of posts) {
              document.getElementById(
                "content"
              ).innerHTML += `<h1>${post.title}</h1>`;
              console.log(post.title);
            }
          } else {
            alert("Error");
            console.log(response);
          }
        };
      }

      readPostsWithIdFilter();
      // readPosts();
    </script>
  </body>
</html>
